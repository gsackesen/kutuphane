const {body}=require('express-validator');



const validateNewUser = () => {
    return[
        body('mail')
            .trim()
            .isEmail().withMessage('mail is not valid'),
        body('ad')
            .trim()
            .isLength({min:3}).withMessage('name must be min 3 characters')
            .isLength({max:30}).withMessage('name must be max 30 characters'),
        body('soyad')
            .trim()
            .isLength({min:3}).withMessage('surname must be min 3 characters')
            .isLength({max:30}).withMessage('surname must be max 30 characters'),
        body('sifre')
            .trim()
            .isLength({min:6}).withMessage('password must be min 6 characters')
            .isLength({max:20}).withMessage('password must be max 20 characters'),
        body('resifre')
            .trim()    
            .custom((value,{req})=>{
                if(value!==req.body.sifre){
                    throw new Error('Password is not matching');
                }
                return true;
            })
        ];
};

const validateLogin = () => {
    return[
        body('mail')
            .trim()
            .isEmail().withMessage('mail is not valid'),        
        body('sifre')
            .trim()
            .isLength({min:6}).withMessage('password must be min 6 characters')
            .isLength({max:20}).withMessage('password must be max 20 characters'),
        
        ];
};


const validateMail = () => {
    return[
        body('mail')
            .trim()
            .isEmail().withMessage('mail is not valid'),        
        ];
};
const validateNewPassword = () => {
    return[        
        body('sifre')
            .trim()
            .isLength({min:6}).withMessage('password must be min 6 characters')
            .isLength({max:20}).withMessage('password must be max 20 characters'),
        body('resifre')
            .trim()    
            .custom((value,{req})=>{
                if(value!==req.body.sifre){
                    throw new Error('Password is not matching');
                }
                return true;
            })
        ];
};
module.exports ={
    validateNewUser,
    validateLogin,
    validateMail,
    validateNewPassword
};